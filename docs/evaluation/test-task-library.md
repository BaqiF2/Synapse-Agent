# Synapse Agent 测试任务库

## 概述

本文档定义了 Synapse Agent 评估中使用的标准化测试任务集。

---

## 任务分类体系

```
测试任务
├── 类别 A: 文件操作类
│   ├── A1: 单文件读取
│   ├── A2: 文件创建
│   ├── A3: 文件编辑
│   ├── A4: 文件删除
│   └── A5: 批量文件操作
├── 类别 B: 代码开发类
│   ├── B1: Bug 修复
│   ├── B2: 功能实现
│   ├── B3: 代码重构
│   └── B4: 测试编写
├── 类别 C: 项目结构类
│   ├── C1: 项目搭建
│   ├── C2: 依赖管理
│   └── C3: 构建配置
├── 类别 D: 信息检索类
│   ├── D1: 代码搜索
│   ├── D2: 文档理解
│   └── D3: 知识问答
├── 类别 E: 复杂任务类
│   ├── E1: 多步骤工作流
│   ├── E2: 跨模块修改
│   └── E3: 集成任务
└── 类别 F: 错误处理类
    ├── F1: 异常恢复
    └── F2: 错误诊断
```

---

## 类别 A: 文件操作类

### A1: 单文件读取

**任务描述**: 读取指定文件并理解其内容

**测试用例**:

| ID | 任务 | 预期结果 |
|----|------|---------|
| A1.1 | 读取项目根目录的 README.md | 正确返回文件内容 |
| A1.2 | 读取 src/core/agent/index.ts | 正确返回文件内容 |
| A1.3 | 读取不存在的文件 | 返回适当的错误信息 |
| A1.4 | 读取大文件 ( >1MB) | 能够读取并返回内容 |
| A1.5 | 读取二进制文件 | 正确处理并返回错误或文本内容 |

**评估要点**:
- 路径解析正确性
- 错误处理恰当性
- 内容返回完整性

### A2: 文件创建

**任务描述**: 创建新文件

**测试用例**:

| ID | 任务 | 预期结果 |
|----|------|---------|
| A2.1 | 在 tests/fixtures/ 创建 test-input.txt | 文件创建成功 |
| A2.2 | 创建嵌套目录下的文件 | 自动创建父目录 |
| A3.3 | 创建同名文件 | 提示覆盖或报错 |
| A2.4 | 创建包含特殊字符文件名 | 正确处理 |
| A2.5 | 创建空文件 | 成功创建 |

**评估要点**:
- 目录自动创建能力
- 冲突处理
- 权限处理

### A3: 文件编辑

**任务描述**: 修改现有文件内容

**测试用例**:

| ID | 任务 | 预期结果 |
|----|------|---------|
| A3.1 | 在 README.md 末尾添加一行 | 内容正确添加 |
| A3.2 | 替换文件中的特定字符串 | 精确替换 |
| A3.3 | 批量替换文件中的内容 | 全部替换 |
| A3.4 | 编辑只读文件 | 提示权限错误 |
| A3.5 | 编辑不存在的文件 | 提示文件不存在 |

**评估要点**:
- 替换准确性
- 批量操作效率
- 错误处理

### A4: 文件删除

**任务描述**: 删除文件或目录

**测试用例**:

| ID | 任务 | 预期结果 |
|----|------|---------|
| A4.1 | 删除指定的测试文件 | 成功删除 |
| A4.2 | 删除非正确处理（报错空目录 | 或递归删除） |
| A4.3 | 删除不存在的文件 | 返回适当错误 |
| A4.4 | 删除只读文件 | 提示权限错误 |
| A4.5 | 删除系统关键文件 | 拒绝删除并警告 |

**评估要点**:
- 安全性控制
- 错误处理
- 确认机制

### A5: 批量文件操作

**任务描述**: 同时处理多个文件

**测试用例**:

| ID | 任务 | 预期结果 |
|----|------|---------|
| A5.1 | 查找所有 .ts 文件 | 返回完整列表 |
| A5.2 | 搜索包含特定内容的文件 | 返回匹配文件 |
| A5.3 | 批量重命名文件 | 全部成功 |
| A5.4 | 批量移动文件 | 全部成功 |
| A5.5 | 批量删除临时文件 | 全部成功 |

**评估要点**:
- 搜索效率
- 结果准确性
- 错误容错性

---

## 类别 B: 代码开发类

### B1: Bug 修复

**任务描述**: 定位并修复代码中的问题

**测试用例**:

| ID | 任务 | 预期结果 |
|----|------|---------|
| B1.1 | 修复一个简单的逻辑错误 | 修复正确且测试通过 |
| B1.2 | 修复类型错误 | 类型正确且无错误 |
| B1.3 | 修复空指针异常 | 正确处理空值 |
| B1.4 | 修复异步问题 | 正确处理异步流程 |
| B1.5 | 修复内存泄漏 | 消除泄漏 |

**评估要点**:
- 问题定位准确性
- 修复方案合理性
- 测试覆盖

### B2: 功能实现

**任务描述**: 实现新功能

**测试用例**:

| ID | 任务 | 预期结果 |
|----|------|---------|
| B2.1 | 实现一个简单的工具函数 | 功能正确实现 |
| B2.2 | 实现一个 API 接口 | 接口符合规范 |
| B2.3 | 实现一个 CLI 命令 | 命令可用 |
| B2.4 | 实现数据处理逻辑 | 处理正确 |
| B2.5 | 实现 UI 组件 | 组件可用 |

**评估要点**:
- 实现正确性
- 代码质量
- 文档完整

### B3: 代码重构

**任务描述**: 改进现有代码结构

**测试用例**:

| ID | 任务 | 预期结果 |
|----|------|---------|
| B3.1 | 提取重复代码为函数 | 消除重复 |
| B3.2 | 重命名变量/函数 | 改善可读性 |
| B3.3 | 拆分大型函数 | 模块化 |
| B3.4 | 优化性能 | 性能提升 |
| B3.5 | 改进代码风格 | 符合规范 |

**评估要点**:
- 功能保持
- 改进效果
- 风险控制

### B4: 测试编写

**任务描述**: 编写测试用例

**测试用例**:

| ID | 任务 | 预期结果 |
|----|------|---------|
| B4.1 | 编写单元测试 | 测试覆盖关键路径 |
| B4.2 | 编写集成测试 | 测试模块交互 |
| B4.3 | 编写 E2E 测试 | 测试完整流程 |
| B4.4 | 添加测试文档 | 文档清晰 |
| B4.5 | 修复失败的测试 | 测试通过 |

**评估要点**:
- 测试覆盖率
- 测试质量
- 可维护性

---

## 类别 C: 项目结构类

### C1: 项目搭建

**任务描述**: 初始化和配置项目

**测试用例**:

| ID | 任务 | 预期结果 |
|----|------|---------|
| C1.1 | 使用模板创建新项目 | 项目结构正确 |
| C1.2 | 配置 TypeScript | 配置正确 |
| C1.3 | 配置 ESLint | 规则生效 |
| C1.4 | 配置测试框架 | 测试可运行 |
| C1.5 | 配置构建工具 | 构建成功 |

**评估要点**:
- 配置正确性
- 依赖完整性
- 可运行性

### C2: 依赖管理

**任务描述**: 管理项目依赖

**测试用例**:

| ID | 任务 | 预期结果 |
|----|------|---------|
| C2.1 | 安装指定依赖 | 安装成功 |
| C2.2 | 更新依赖到新版本 | 更新成功 |
| C2.3 | 移除未使用依赖 | 移除成功 |
| C2.4 | 解决依赖冲突 | 冲突解决 |
| C2.5 | 锁定依赖版本 | 版本锁定 |

**评估要点**:
- 操作正确性
- 依赖一致性
- 兼容性

### C3: 构建配置

**任务描述**: 配置构建流程

**测试用例**:

| ID | 任务 | 预期结果 |
|----|------|---------|
| C3.1 | 配置生产构建 | 构建成功 |
| C3.2 | 配置开发构建 | 热重载可用 |
| C3.3 | 配置代码分割 | 分割正确 |
| C3.4 | 配置环境变量 | 变量正确加载 |
| C3.5 | 配置输出目录 | 输出正确 |

**评估要点**:
- 构建成功
- 输出正确
- 性能优化

---

## 类别 D: 信息检索类

### D1: 代码搜索

**任务描述**: 在代码库中搜索信息

**测试用例**:

| ID | 任务 | 预期结果 |
|----|------|---------|
| D1.1 | 搜索函数定义 | 定位准确 |
| D1.2 | 搜索函数调用 | 列出所有调用 |
| D1.3 | 搜索特定字符串 | 结果完整 |
| D1.4 | 搜索正则表达式 | 匹配正确 |
| D1.5 | 搜索文件模式 | 文件列表正确 |

**评估要点**:
- 搜索准确性
- 结果完整性
- 性能

### D2: 文档理解

**任务描述**: 理解和解释文档

**测试用例**:

| ID | 任务 | 预期结果 |
|----|------|---------|
| D2.1 | 解释代码功能 | 解释准确 |
| D2.2 | 总结文档要点 | 要点完整 |
| D2.3 | 提取 API 用法 | 用法正确 |
| D2.4 | 解释配置项 | 解释清晰 |
| D2.5 | 对比两个版本差异 | 差异准确 |

**评估要点**:
- 理解准确性
- 表达清晰度
- 重点突出

### D3: 知识问答

**任务描述**: 回答技术问题

**测试用例**:

| ID | 任务 | 预期结果 |
|----|------|---------|
| D3.1 | 解释技术概念 | 解释正确 |
| D3.2 | 提供最佳实践 | 建议合理 |
| D3.3 | 给出代码示例 | 示例正确 |
| D3.4 | 排查问题原因 | 原因准确 |
| D3.5 | 推荐解决方案 | 方案可行 |

**评估要点**:
- 答案准确性
- 实用性
- 深度

---

## 类别 E: 复杂任务类

### E1: 多步骤工作流

**任务描述**: 执行需要多个步骤的任务

**测试用例**:

| ID | 任务 | 步骤 | 预期结果 |
|----|------|------|---------|
| E1.1 | 创建新功能模块 | 1.创建目录<br>2.创建文件<br>3.编写代码<br>4.编写测试 | 全部完成 |
| E1.2 | 修复并验证 Bug | 1.定位问题<br>2.修复代码<br>3.运行测试 | 修复成功 |
| E1.3 | 重构并测试 | 1.重构代码<br>2.运行测试<br>3.更新文档 | 全部完成 |

**评估要点**:
- 步骤完整性
- 执行顺序
- 结果正确性

### E2: 跨模块修改

**任务描述**: 修改多个模块的代码

**测试用例**:

| ID | 任务 | 预期结果 |
|----|------|---------|
| E2.1 | 修改 API 接口并更新调用方 | 全部更新 |
| E2.2 | 提取共享代码到公共模块 | 提取成功 |
| E2.3 | 统一错误处理方式 | 处理一致 |
| E2.4 | 添加全局配置 | 配置生效 |
| E2.5 | 修改数据类型 | 类型统一 |

**评估要点**:
- 变更一致性
- 依赖管理
- 回归测试

### E3: 集成任务

**任务描述**: 集成外部系统或服务

**测试用例**:

| ID | 任务 | 预期结果 |
|----|------|---------|
| E3.1 | 集成 MCP 工具 | 工具可用 |
| E3.2 | 集成新的 LLM Provider | 调用成功 |
| E3.3 | 集成第三方库 | 功能正常 |
| E3.4 | 配置 CI/CD | 流程可用 |
| E3.5 | 部署到环境 | 部署成功 |

**评估要点**:
- 集成正确性
- 错误处理
- 文档完整

---

## 类别 F: 错误处理类

### F1: 异常恢复

**任务描述**: 从错误状态恢复

**测试用例**:

| ID | 场景 | 预期行为 |
|----|------|---------|
| F1.1 | 工具执行失败 | 报告错误并尝试恢复 |
| F1.2 | 文件操作失败 | 提供替代方案 |
| F1.3 | API 调用失败 | 重试或降级 |
| F1.4 | 权限不足 | 请求权限或提示 |
| F1.5 | 超时 | 延长超时或分解任务 |

**评估要点**:
- 恢复策略
- 用户提示
- 最终结果

### F2: 错误诊断

**任务描述**: 诊断和定位问题

**测试用例**:

| ID | 场景 | 预期行为 |
|----|------|---------|
| F2.1 | 构建失败 | 定位失败原因 |
| F2.2 | 测试失败 | 定位失败测试 |
| F2.3 | 运行错误 | 定位错误位置 |
| F2.4 | 性能问题 | 定位瓶颈 |
| F2.5 | 内存泄漏 | 定位泄漏点 |

**评估要点**:
- 定位准确性
- 分析深度
- 建议有效性

---

## 难度等级定义

| 等级 | 描述 | 特征 |
|------|------|------|
| L1 - 简单 | 单步操作 | 单一工具、明确指令 |
| L2 - 中等 | 多步操作 | 2-3个工具、需要推理 |
| L3 - 困难 | 复杂工作流 | 多模块、需要规划 |
| L4 - 专家 | 开放任务 | 需要创造性、深度理解 |

---

## 任务选择指南

### 日常评估 (快速)

选择 5-10 个任务，覆盖:
- 2 个 L1 任务
- 3 个 L2 任务
- 2 个 L3 任务

### 全面评估

选择 30-50 个任务，覆盖:
- 所有类别
- 所有难度等级

### 回归测试

选择核心功能任务:
- 5 个文件操作
- 5 个代码开发
- 3 个复杂任务
